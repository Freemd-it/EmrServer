{"version":3,"sources":["../../Service/DBService.js"],"names":["mysql","require","config","util","DBService","Init","_pool","createPool","host","storeConfig","mysqlHost","user","mysqlUser","password","mysqlPassword","database","mysqlDatabase","connectionLimit","on","console","log","format","Query","query","value","succEvent","getConnection","err","connection","rows","release","module","exports"],"mappings":";;AAAA,IAAIA,QAAQC,QAAQ,OAAR,CAAZ;AACA,IAAIC,SAASD,QAAQ,qBAAR,CAAb;AACA,IAAIE,OAAOF,QAAQ,MAAR,CAAX;;AAEA,IAAIG,YAAY,SAAZA,SAAY,GAAU,CAAE,CAA5B;;AAEAA,UAAUC,IAAV,GAAiB,YAAY;AACzB,SAAKC,KAAL,GAAaN,MAAMO,UAAN,CAAiB;AAC1BC,cAAMN,OAAOO,WAAP,CAAmBC,SADC;AAE1BC,cAAMT,OAAOO,WAAP,CAAmBG,SAFC;AAG1BC,kBAAUX,OAAOO,WAAP,CAAmBK,aAHH;AAI1BC,kBAAUb,OAAOO,WAAP,CAAmBO,aAJH;AAK1BC,yBAAiBf,OAAOO,WAAP,CAAmBQ;AALV,KAAjB,CAAb;;AAQA;AACA,SAAKX,KAAL,CAAWY,EAAX,CAAc,SAAd,EAAyB,YAAY;AACjCC,gBAAQC,GAAR,CAAYjB,KAAKkB,MAAL,CAAY,6CAAZ,CAAZ;AACH,KAFD;;AAIAF,YAAQC,GAAR,CAAYjB,KAAKkB,MAAL,CAAY,uBAAZ,CAAZ;AACH,CAfD;;AAiBAjB,UAAUkB,KAAV,GAAkB,UAAUC,KAAV,EAAiBC,KAAjB,EAAwBC,SAAxB,EAAmC;AACjD,SAAKnB,KAAL,CAAWoB,aAAX,CAAyB,UAAUC,GAAV,EAAeC,UAAf,EAA2B;AAChDA,mBAAWL,KAAX,CAAiBA,KAAjB,EAAwBC,KAAxB,EAA+B,UAAUG,GAAV,EAAeE,IAAf,EAAqB;AAChD,gBAAIF,GAAJ,EAAS;AACLC,2BAAWE,OAAX;AACA,sBAAMH,GAAN;AACH;;AAEDF,sBAAUI,IAAV;AACAD,uBAAWE,OAAX;AACH,SARD;AASH,KAVD;AAWH,CAZD;;AAcAC,OAAOC,OAAP,GAAiB5B,SAAjB","file":"DBService.js","sourcesContent":["var mysql = require('mysql');\r\nvar config = require('../common/Config.js');\r\nvar util = require('util');\r\n\r\nvar DBService = function(){};\r\n\r\nDBService.Init = function () {\r\n    this._pool = mysql.createPool({\r\n        host: config.storeConfig.mysqlHost,\r\n        user: config.storeConfig.mysqlUser,\r\n        password: config.storeConfig.mysqlPassword,\r\n        database: config.storeConfig.mysqlDatabase,\r\n        connectionLimit: config.storeConfig.connectionLimit,\r\n    });\r\n\r\n    // 사용 가능한 커넥션이 없을경우\r\n    this._pool.on('enqueue', function () {\r\n        console.log(util.format(\"## Waiting for available connection slot ##\"));\r\n    });\r\n\r\n    console.log(util.format('## mysql connected ##'));\r\n};\r\n\r\nDBService.Query = function (query, value, succEvent) {\r\n    this._pool.getConnection(function (err, connection) {\r\n        connection.query(query, value, function (err, rows) {\r\n            if (err) {\r\n                connection.release();\r\n                throw err;\r\n            }\r\n\r\n            succEvent(rows);\r\n            connection.release();\r\n        });\r\n    });\r\n};\r\n\r\nmodule.exports = DBService;\r\n"]}