{"version":3,"sources":["../../Model/FriendTalkModel.js"],"names":["dbService","require","config","querySetter","FriendTalkModel","data","table","prototype","SendMessage","insertValues","stamp","callback","insertFields","queryObject","Insert","Query","query","fieldAndValue","result","IotSendMessage","console","log","returnObject","code","cmid","message","module","exports"],"mappings":";;AAAA,IAAIA,YAAYC,QAAQ,yBAAR,CAAhB;AACA,IAAIC,SAASD,QAAQ,qBAAR,CAAb;AACA,IAAIE,cAAcF,QAAQ,0BAAR,CAAlB;;AAEA,IAAIG,kBAAkB,SAAlBA,eAAkB,CAAUC,IAAV,EAAgB;AAClC,SAAKA,IAAL,GAAYA,IAAZ;AACH,CAFD;;AAIA,IAAIC,QAAQ,SAAZ;;AAEAF,gBAAgBG,SAAhB,CAA0BF,IAA1B,GAAiC,EAAjC;;AAEAD,gBAAgBI,WAAhB,GAA8B,UAASC,YAAT,EAAuBC,KAAvB,EAA8BC,QAA9B,EAAuC;;AAEjE,QAAIC,eAAe,CAAC,UAAD,EAAa,MAAb,EAAqB,cAArB,EAAqC,WAArC,EAAkD,YAAlD,EAAgE,YAAhE,EAA8E,SAA9E,EAAyF,UAAzF,EAAqG,YAArG,EAAmH,aAAnH,EAAkI,iBAAlI,EAAqJ,SAArJ,EAAgK,SAAhK,EAA2K,eAA3K,CAAnB;AACA,QAAIC,cAAcV,YAAYW,MAAZ,CAAmBR,KAAnB,EAA0BG,YAA1B,EAAwCG,YAAxC,EAAsDF,KAAtD,CAAlB;;AAEAV,cAAUe,KAAV,CAAgBF,YAAYG,KAA5B,EAAmCH,YAAYI,aAA/C,EAA8D,UAASC,MAAT,EAAgB;;AAE1EP,iBAASO,OAAO,CAAP,CAAT;AACH,KAHD;AAIH,CATD;;AAWAd,gBAAgBe,cAAhB,GAAiC,UAASV,YAAT,EAAuBC,KAAvB,EAA8BC,QAA9B,EAAuC;;AAEpE,QAAIC,eAAe,CAAC,UAAD,EAAa,MAAb,EAAqB,cAArB,EAAqC,WAArC,EAAkD,YAAlD,EAAgE,YAAhE,EAA8E,YAA9E,EAA4F,aAA5F,EAA2G,iBAA3G,EAA8H,UAA9H,CAAnB;AACA,QAAIC,cAAcV,YAAYW,MAAZ,CAAmBR,KAAnB,EAA0BG,YAA1B,EAAwCG,YAAxC,EAAsDF,KAAtD,CAAlB;;AAEAU,YAAQC,GAAR,CAAY,mBAAZ;AACAD,YAAQC,GAAR,CAAYR,WAAZ;AACAO,YAAQC,GAAR,CAAY,iBAAZ;;AAEA,QAAIC,eAAe,EAAnB;;AAEA,QAAIT,gBAAgB,iBAApB,EAAsC;;AAElCS,qBAAaC,IAAb,GAAoB,MAApB;AACAD,qBAAaE,IAAb,GAAoB,IAApB;AACAF,qBAAaG,OAAb,GAAuB,iBAAvB;;AAEAd,iBAASW,YAAT;AACH,KAPD,MASA;AACItB,kBAAUe,KAAV,CAAgBF,YAAYG,KAA5B,EAAmCH,YAAYI,aAA/C,EAA8D,YAAU;;AAEpEK,yBAAaC,IAAb,GAAoB,MAApB;AACAD,yBAAaE,IAAb,GAAoBX,YAAYI,aAAZ,CAA0B,EAA1B,CAApB;AACAK,yBAAaG,OAAb,GAAuB,cAAvB;;AAEAd,qBAASW,YAAT;AACH,SAPD;AAQH;AACJ,CA9BD;;AAgCAI,OAAOC,OAAP,GAAiBvB,eAAjB","file":"FriendTalkModel.js","sourcesContent":["var dbService = require('../Service/DBService.js');\r\nvar config = require('../Common/Config.js');\r\nvar querySetter = require('../Common/QuerySetter.js');\r\n\r\nvar FriendTalkModel = function (data) {\r\n    this.data = data;\r\n}\r\n\r\nvar table = \"kmp_msg\";\r\n\r\nFriendTalkModel.prototype.data = {};\r\n\r\nFriendTalkModel.SendMessage = function(insertValues, stamp, callback){\r\n\r\n    var insertFields = [\"MSG_TYPE\", \"CMID\", \"REQUEST_TIME\", \"SEND_TIME\", \"DEST_PHONE\", \"SEND_PHONE\", \"SUBJECT\", \"MSG_BODY\", \"SENDER_KEY\", \"NATION_CODE\", \"RESPONSE_METHOD\", \"RE_TYPE\", \"RE_BODY\", \"ATTACHED_FILE\"];\r\n    var queryObject = querySetter.Insert(table, insertValues, insertFields, stamp);\r\n\r\n    dbService.Query(queryObject.query, queryObject.fieldAndValue, function(result){\r\n\r\n        callback(result[0]);\r\n    });\r\n}\r\n\r\nFriendTalkModel.IotSendMessage = function(insertValues, stamp, callback){\r\n\r\n    var insertFields = [\"MSG_TYPE\", \"CMID\", \"REQUEST_TIME\", \"SEND_TIME\", \"DEST_PHONE\", \"SEND_PHONE\", \"SENDER_KEY\", \"NATION_CODE\", \"RESPONSE_METHOD\", \"MSG_BODY\"];\r\n    var queryObject = querySetter.Insert(table, insertValues, insertFields, stamp);\r\n\r\n    console.log(\"## Query Start ##\");\r\n    console.log(queryObject);\r\n    console.log(\"## Query End ##\");\r\n\r\n    var returnObject = {};\r\n\r\n    if (queryObject === \"Parameter ERROR\"){\r\n\r\n        returnObject.code = \"9999\";\r\n        returnObject.cmid = null;\r\n        returnObject.message = \"Parameter ERROR\";\r\n\r\n        callback(returnObject);\r\n    }\r\n    else\r\n    {\r\n        dbService.Query(queryObject.query, queryObject.fieldAndValue, function(){\r\n\r\n            returnObject.code = \"0000\";\r\n            returnObject.cmid = queryObject.fieldAndValue[12];\r\n            returnObject.message = \"send SUCCESS\";\r\n\r\n            callback(returnObject);\r\n        });\r\n    }\r\n}\r\n\r\nmodule.exports = FriendTalkModel;\r\n"]}