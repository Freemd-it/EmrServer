{"version":3,"sources":["../../Model/AlimTalkModel.js"],"names":["moment","require","dbService","config","querySetter","AlimTalkModel","data","messageTable","logTable","String","format","stamp","prototype","SendMessage","insertValues","callback","insertFields","queryObject","Insert","Query","query","fieldAndValue","SendResultCheck","primaryKey","selectFields","ResultCheckSelectQuery","selectField","result","ReSendResultCheck","ReSendResultCheckSelectQuery","error","module","exports"],"mappings":";;AAAA,IAAIA,SAASC,QAAQ,QAAR,CAAb;;AAEA,IAAIC,YAAYD,QAAQ,yBAAR,CAAhB;AACA,IAAIE,SAASF,QAAQ,qBAAR,CAAb;AACA,IAAIG,cAAcH,QAAQ,0BAAR,CAAlB;;AAEA,IAAII,gBAAgB,SAAhBA,aAAgB,CAAUC,IAAV,EAAgB;AAChC,SAAKA,IAAL,GAAYA,IAAZ;AACH,CAFD;;AAIA,IAAIC,eAAe,SAAnB;AACA,IAAIC,WAAW,aAAWC,OAAOT,SAASU,MAAT,CAAgB,QAAhB,CAAP,CAA1B;AACA,IAAIC,QAAQ,IAAZ;;AAEAN,cAAcO,SAAd,CAAwBN,IAAxB,GAA+B,EAA/B;;AAEAD,cAAcQ,WAAd,GAA4B,UAASC,YAAT,EAAuBC,QAAvB,EAAgC;;AAExD,QAAIC,eAAe,CAAC,UAAD,EAAa,MAAb,EAAqB,cAArB,EAAqC,WAArC,EAAkD,YAAlD,EAAgE,YAAhE,EAA8E,UAA9E,EAA0F,eAA1F,EAA2G,YAA3G,EAAyH,aAAzH,EAAwI,iBAAxI,EAA2J,SAA3J,EAAsK,SAAtK,EAAiL,eAAjL,CAAnB;AACA,QAAIC,cAAcb,YAAYc,MAAZ,CAAmBX,YAAnB,EAAiCO,YAAjC,EAA+CE,YAA/C,EAA6DL,KAA7D,CAAlB;;AAEAT,cAAUiB,KAAV,CAAgBF,YAAYG,KAA5B,EAAmCH,YAAYI,aAA/C,EAA8D,YAAU;;AAEpEN,iBAASE,YAAYI,aAAZ,CAA0B,EAA1B,CAAT,EAFoE,CAE3B;AAC5C,KAHD;AAIH,CATD;;AAWAhB,cAAciB,eAAd,GAAgC,UAASC,UAAT,EAAqBR,QAArB,EAA8B;;AAE1D,QAAIS,eAAe,CAAC,UAAD,EAAa,MAAb,EAAqB,MAArB,EAA6B,cAA7B,EAA6C,aAA7C,CAAnB;AACA,QAAIP,cAAcb,YAAYqB,sBAAZ,CAAmClB,YAAnC,EAAiDgB,UAAjD,EAA6DC,YAA7D,CAAlB;;AAEAtB,cAAUiB,KAAV,CAAgBF,YAAYG,KAA5B,EAAmCH,YAAYS,WAA/C,EAA4D,UAASC,MAAT,EAAgB;;AAExEZ,iBAASY,OAAO,CAAP,CAAT;AACH,KAHD;AAIH,CATD;;AAWAtB,cAAcuB,iBAAd,GAAkC,UAASL,UAAT,EAAqBR,QAArB,EAA8B;;AAE5D,QAAIS,eAAe,CAAC,UAAD,EAAa,UAAb,EAAyB,QAAzB,EAAmC,MAAnC,EAA2C,MAA3C,EAAmD,cAAnD,EAAmE,aAAnE,CAAnB;AACA,QAAIP,cAAcb,YAAYyB,4BAAZ,CAAyCtB,YAAzC,EAAuDgB,UAAvD,EAAmEC,YAAnE,CAAlB;;AAEAtB,cAAUiB,KAAV,CAAgBF,YAAYG,KAA5B,EAAmCH,YAAYS,WAA/C,EAA4D,UAASC,MAAT,EAAiBG,KAAjB,EAAuB;;AAE/Ef,iBAASY,OAAO,CAAP,CAAT;AACH,KAHD;AAIH,CATD;;AAWAI,OAAOC,OAAP,GAAiB3B,aAAjB","file":"AlimTalkModel.js","sourcesContent":["var moment = require('moment');\r\n\r\nvar dbService = require('../Service/DBService.js');\r\nvar config = require('../Common/Config.js');\r\nvar querySetter = require('../Common/QuerySetter.js');\r\n\r\nvar AlimTalkModel = function (data) {\r\n    this.data = data;\r\n}\r\n\r\nvar messageTable = \"kmp_msg\";\r\nvar logTable = \"kmp_log_\"+String(moment().format(\"YYYYMM\"));\r\nvar stamp = \"AT\";\r\n\r\nAlimTalkModel.prototype.data = {};\r\n\r\nAlimTalkModel.SendMessage = function(insertValues, callback){\r\n\r\n    var insertFields = [\"MSG_TYPE\", \"CMID\", \"REQUEST_TIME\", \"SEND_TIME\", \"DEST_PHONE\", \"SEND_PHONE\", \"MSG_BODY\", \"TEMPLATE_CODE\", \"SENDER_KEY\", \"NATION_CODE\", \"RESPONSE_METHOD\", \"RE_TYPE\", \"RE_BODY\", \"ATTACHED_FILE\"];\r\n    var queryObject = querySetter.Insert(messageTable, insertValues, insertFields, stamp);\r\n\r\n    dbService.Query(queryObject.query, queryObject.fieldAndValue, function(){\r\n\r\n        callback(queryObject.fieldAndValue[16]); // 16번 값 = CMID 값\r\n    });\r\n}\r\n\r\nAlimTalkModel.SendResultCheck = function(primaryKey, callback){\r\n\r\n    var selectFields = [\"MSG_TYPE\", \"CMID\", \"UMID\", \"REQUEST_TIME\", \"CALL_STATUS\"];\r\n    var queryObject = querySetter.ResultCheckSelectQuery(messageTable, primaryKey, selectFields);\r\n\r\n    dbService.Query(queryObject.query, queryObject.selectField, function(result){\r\n\r\n        callback(result[0]);\r\n    });\r\n}\r\n\r\nAlimTalkModel.ReSendResultCheck = function(primaryKey, callback){\r\n\r\n    var selectFields = [\"MSG_TYPE\", \"TEL_INFO\", \"STATUS\", \"CMID\", \"UMID\", \"REQUEST_TIME\", \"CALL_STATUS\"];\r\n    var queryObject = querySetter.ReSendResultCheckSelectQuery(messageTable, primaryKey, selectFields);\r\n\r\n    dbService.Query(queryObject.query, queryObject.selectField, function(result, error){\r\n\r\n        callback(result[0]);\r\n    });\r\n}\r\n\r\nmodule.exports = AlimTalkModel;\r\n"]}